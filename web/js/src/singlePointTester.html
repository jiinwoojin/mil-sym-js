<!DOCTYPE html>
<html>
<head>
<!-- Meta line required for IE-->
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>single point tester</title>
    <link rel="stylesheet" href="renderer.css" type="text/css" charset="utf-8" />
    <!-- Not necessary as fonts are body fonts set in renderer.css
    <style type="text/css">
    body 
    {
        font-family: UnitFont, SinglePoint, TacticalGraphics;
        font-size: 48pt;
        padding: 25px;
    }
    </style> -->
	<script src="include-mpsp.js" type="text/javascript" ></script>
	    
    <script type = "text/javascript">
	
	var fontCheckTimer =  null;
	var retries = 15;
	var attempts = 0;
	
	function testRender()
	{
		//armyc2.c2sd.renderer.utilities.RendererSettings.setTextBackgroundMethod(3);
		armyc2.c2sd.renderer.utilities.RendererSettings.setTextOutlineWidth(1);
			//armyc2.c2sd.renderer.utilities.RendererUtilities.fontsLoaded();
           
		   armyc2.c2sd.renderer.utilities.RendererSettings.setModifierFont("arial",9,"bold");
		   
            var msa = armyc2.c2sd.renderer.utilities.MilStdAttributes;
            //armyc2.c2sd.renderer.MilStdIconRenderer.Init();
            //armyc2.c2sd.renderer.utilities.RendererSettings.setTextOutlineWidth(1);
            var preview = document.getElementById("preview");
            var ctx = preview.getContext('2d');
            //var image = render2();
            //SET MODIFIERS/////////////////////////////////////////////////
            var modifiers = {};
            //modifiers[msa.PixelSize]=45;//S*G*USAT--*****//OUOPYT----*B***
            //modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.Q_DIRECTION_OF_MOVEMENT]=45;
            //modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.C_QUANTITY]=10;
            //modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.X_ALTITUDE_DEPTH] = "X";
            //modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.Y_LOCATION] = "Y";
            //modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.G_STAFF_COMMENTS] = "G";


            //modifiers = populateModifiers();
            modifiers[msa.PixelSize]=undefined;
            modifiers[msa.KeepUnitRatio]=true;
            modifiers[msa.SymbologyStandard] = 1;
            modifiers[msa.Alpha] = 55;
			//modifiers[msa.Icon]=true;
            //CALL TO RENDER////////////////////////////////////////////////
            //var iiTG = armyc2.c2sd.renderer.MilStdIconRenderer.Render("UPPS-----*****",modifiers);
            //SUGDUSAT--FM***//"SUGDUSAT--MY***"
            //var ii = armyc2.c2sd.renderer.MilStdIconRenderer.Render("SHGDUSAT----US*",modifiers);
            modifiers = {H:"",H1:"",H2:"",KEEPUNITRATIO:true,SIZE:undefined,T:"",T1:"",W:"",W1:""};
            var ii = armyc2.c2sd.renderer.MilStdIconRenderer.Render("OHOPHT--------*",modifiers);

            var showDrawAreas = true;

            //image bounds


            if(showDrawAreas)
            {
                //draw square behind so we know the size of buffer we created.
                var imageBounds = ii.getImageBounds();
                ctx.strokeStyle="#FF0000";
                imageBounds.stroke(ctx);

                //symbol bounds
                var symbolBounds = ii.getSymbolBounds();
                ctx.strokeStyle="#0000FF";
                symbolBounds.stroke(ctx);
            }

            //draw symbol
            ctx.drawImage(ii.getImage(), 0, 0);

            if(showDrawAreas)
            {
                //center point
                var centerPoint = ii.getCenterPoint();
                ctx.strokeStyle="#FF0000";
                ctx.fillStyle="#FF0000";
                ctx.lineWidth=3;
                centerPoint.stroke(ctx);
            }

			//modifiers[msa.Icon]=true;
			
            //image = render3();
            //G*M*NZ----****X//nuclear detonation
            //G*GPGPP---****X//action point, has H1
            //GUGPOPP---****X//point of departure (action point)
            //G*O*ES------**X//Distress call, has T1
            //SUPPS-----*****//satellite
            //
            //var iiTG = armyc2.c2sd.renderer.MilStdIconRenderer.Render("GFGPGPP---****X",modifiers);
            //var iiTG = armyc2.c2sd.renderer.MilStdIconRenderer.Render("GFOPES----****X",modifiers);
            var iiTG = armyc2.c2sd.renderer.MilStdIconRenderer.Render("GFGPGPP---****X",modifiers);
            //var iiTG = armyc2.c2sd.renderer.MilStdIconRenderer.Render("GFMPNZ----****X",modifiers);
            //var iiTG = armyc2.c2sd.renderer.MilStdIconRenderer.Render("G*M*OFS---****X",modifiers);
            //
            //draw image
            ctx.drawImage(iiTG.getImage(), Math.ceil(ii.getImageBounds().getWidth() + 10), 0);


            if(showDrawAreas)
            {
                //draw square behind so we know the size of buffer we created.
                ctx.lineWidth=1;
                var imageBoundsTG = iiTG.getImageBounds();
                imageBoundsTG.shift(ii.getImageBounds().getWidth() + 10,0);
                ctx.strokeStyle="#FF0000";
                imageBoundsTG.stroke(ctx);

                //symbol bounds
                var symbolBoundsTG = iiTG.getSymbolBounds();
                symbolBoundsTG.shift(ii.getImageBounds().getWidth() + 10,0);
                ctx.strokeStyle="#0000FF";
                symbolBoundsTG.stroke(ctx);

                //center point
                var centerPointTG = iiTG.getCenterPoint();
                ctx.strokeStyle="#FF0000";
                ctx.fillStyle="#FF0000";
                ctx.lineWidth=3;
                //shift because we're not drawing image at 0,0
                centerPointTG.shift(ii.getImageBounds().getWidth() + 10,0);
                centerPointTG.stroke(ctx);//*/
            }


            //canvas border
            ctx.strokeStyle="#000000";
            ctx.beginPath();
            ctx.moveTo(0,0);
            ctx.lineTo(650,0);
            ctx.lineTo(650,200);
            ctx.lineTo(0,200);
            ctx.lineTo(0,0);
            ctx.stroke();//*/

            modifiers = new Object(); 
            modifiers[msa.PixelSize]=60;//S*G*USAT--*****//OUOPYT----*B***}
            //modifiers[msa.LineColor]="#FFFF00";
            //WA-DPFCU---L---  //Upper Cold Front (Blue)
            //"GHGPSLA---****X" // ambush
            var mods = {};
            mods[msa.KeepUnitRatio] = true;
            mods[msa.PixelSize] = 50;//
            mods[msa.SymbologyStandard] = 1;
            //mods[msa.Alpha] = 55;
            mods["T"] = "";
            var iiTGMP = armyc2.c2sd.renderer.MilStdIconRenderer.Render("SHGPUCA--------",mods);
            //var iiTGMP = armyc2.c2sd.renderer.MilStdIconRenderer.Render("WA-DPFCU---L---",modifiers);
            //var iiTGMP = armyc2.c2sd.renderer.MilStdIconRenderer.Render("GHGPSLA---****X",modifiers);

            ctx.drawImage(iiTGMP.getImage(), Math.ceil(ii.getImageBounds().getWidth() + iiTG.getImageBounds().getWidth() + 20), 0);

            if(showDrawAreas)
            {
                //symbol bounds
                var symbolBoundsTGMP = iiTGMP.getSymbolBounds();
                symbolBoundsTGMP.shift(ii.getImageBounds().getWidth() + iiTG.getImageBounds().getWidth() + 20,0);
                ctx.strokeStyle="#0000FF";
                ctx.lineWidth=1;
                symbolBoundsTGMP.stroke(ctx);
            }
			
			///////////////////////////////////////
			
			modifiers = new Object(); 
            //S*G*USAT--*****//OUOPYT----*B***}
            //modifiers[msa.LineColor]="#FFFF00";
            //WA-DPFCU---L---  //Upper Cold Front (Blue)
            //"GHGPSLA---****X" // ambush
            var mods = {};
            mods[msa.Icon] = false;
            mods[msa.PixelSize] = 40;//
            mods[msa.SymbologyStandard] = 1;
            //mods[msa.Alpha] = 55;
            mods["T"] = "foo";
            var iiTest = armyc2.c2sd.renderer.MilStdIconRenderer.Render("GHGPGPPC----**X",mods);//
			//var iiTest = armyc2.c2sd.renderer.MilStdIconRenderer.Render("GHGPGPPO--****X",mods)

            ctx.drawImage(iiTest.getImage(), Math.ceil(ii.getImageBounds().getWidth() + iiTG.getImageBounds().getWidth() + iiTGMP.getImageBounds().getWidth() + 40), 0);

            if(showDrawAreas)
            {
                //symbol bounds
                var symbolBoundsTest = iiTest.getSymbolBounds();
                symbolBoundsTest.shift(ii.getImageBounds().getWidth() + iiTG.getImageBounds().getWidth() + iiTGMP.getImageBounds().getWidth() + 40,0);
                ctx.strokeStyle="#0000FF";
                ctx.lineWidth=1;
                symbolBoundsTest.stroke(ctx);
				
				var symbolBoundsTest2 = new armyc2.c2sd.renderer.so.Rectangle(0,0,iiTest.getImage().width, iiTest.getImage().height);
                symbolBoundsTest2.shift(ii.getImageBounds().getWidth() + iiTG.getImageBounds().getWidth() + iiTGMP.getImageBounds().getWidth() + 40,0);
                ctx.strokeStyle="#00FF00";
                ctx.lineWidth=1;
                symbolBoundsTest2.stroke(ctx);
            }
			
			
			/*
			ctx.strokeStyle="#FFFFFF"
			ctx.fillStyle="#000000"
            ctx.font = "bold 10pt Arial";
			ctx.lineWidth = 3;
			ctx.strokeText("Clean",100,150);
			ctx.fillText("Clean",100,150);
			ctx.strokeText("Fuzzy",150.5,150);
			ctx.fillText("Fuzzy",150.5,150);//*/
			
            
            //ImageInfo Tests//////////////////////////////////////////////////////////////
            /*
            modifiers = {};
            modifiers[msa.PixelSize]=60;
            modifiers[msa.KeepUnitRatio]=true;
            modifiers[msa.SymbologyStandard] = 1;
            //modifiers[msa.LineColor] = "#FFFFFF";
            ii = armyc2.c2sd.renderer.MilStdIconRenderer.Render("GFGPGPP---****X",modifiers);
            ctx.drawImage(ii.getCenteredImage(),20,120);
            ii = armyc2.c2sd.renderer.MilStdIconRenderer.Render("SFGPUSAT----***",modifiers);            
            ctx.drawImage(ii.getSquareIcon(),90,120);//*/

            //Specific Frame Test///////////////////////////////////////////////
            /*
            ctx.font = 150 + "pt UnitFont";
            ctx.fillStyle = "#000000";
            var frame = String.fromCharCode(844);
            ctx.fillText(frame, 100, 100);//*/

            //armyc2.c2sd.renderer.utilities.SO.Rectangle.union(a,b);
            //var foo = new armyc2.c2sd.renderer.utilities.SO.Rectangle(0,0,1,1)
            //foo.unio

            //Test Font Metrics
            ctx.font = "bold 10pt Arial";
            console.log(armyc2.c2sd.renderer.utilities.RendererSettings.getTextOutlineWidth());
            var ti = new armyc2.c2sd.renderer.utilities.TextInfo("Testing", 30,120, ctx, "bold 10pt Arial");
            ctx.lineWidth = 2;
            ctx.strokeStyle = "#00FF00";
            console.log(ti.getTextBounds());
            var tb = ti.getTextBounds();
            tb = new armyc2.c2sd.renderer.so.Rectangle(tb.x,tb.y,tb.width,tb.height);
            tb.stroke(ctx);
            ctx.strokeStyle = "#FF0000";
            var tob = ti.getTextOutlineBounds();
            tob = new armyc2.c2sd.renderer.so.Rectangle(tob.x,tob.y,tob.width,tob.height);
            tob.stroke(ctx);
            ctx.fillStyle = "#FFFFFF";
            ctx.strokeStyle = "#FFFFFF";
            ctx.globalAlpha = 1.0;
            //ti.outlineText(ctx);
            ti.strokeText(ctx);
            ctx.fillStyle = "#000000";
            ti.fillText(ctx);

            //string replace speed check//////////////////////////
            /*
            var SymbolUtilities = armyc2.c2sd.renderer.utilities.SymbolUtilities;
            var start = new Date().getTime();
            var str = "fd&fdsafd&fdsafdsaf&";
            var temp = "";
            for(var i = 0; i < 1000; i++)
            {
                temp = str;
                temp = temp.replace(/\&/g,"&amp;");
            }
            console.log(temp);
            var end = new Date().getTime();
            var time = end - start;
			
            var pos = 0;  
            //doesn't work
			var start2 = new Date().getTime();
            
			for(var j = 0; j < 1000; j++)
            {
                temp = str;
                var x = -1;
                while(pos < temp.length && (x = temp.indexOf("&",pos) >= 0))
                {
                    temp = temp.replace("&","&amp;");
                    pos = pos + 2;
                }
                
            }
            console.log(temp);
			var end2 = new Date().getTime();
            var time2 = end2 - start2;
            
            var start3 = new Date().getTime();  
			for(var j = 0; j < 1000; j++)
            {
                temp = str;
                var x = -1;
                while(pos < temp.length && (x = temp.indexOf("&",pos) >= 0))
                {
                    temp = temp.substr(0,x) + "&amp;" + temp.substr(x + 1);
                    pos = pos + 2;
                }
                
            }
            console.log(temp);
			var end3 = new Date().getTime();
            var time3 = end3 - start3;
			
			var myTimeMessage = "regex: " + (time/1000) + "\n" +
                                "indexOf with substr: " + (time3/1000);
            alert(myTimeMessage);//*/
			
            //namespace speed check//////////////////////////
            /*
            var SymbolUtilities = armyc2.c2sd.renderer.utilities.SymbolUtilities;
            var start = new Date().getTime();

            for(var i = 0; i < 1000000; i++)
            {
                armyc2.c2sd.renderer.utilities.SymbolUtilities.getBasicSymbolIDStrict("SUGDUSAT--MY***");
            }

            var end = new Date().getTime();
            var time = end - start;
			
			var start2 = new Date().getTime();            
			for(var j = 0; j < 1000000; j++)
            {
                SymbolUtilities.getBasicSymbolIDStrict("SUGDUSAT--MY***");
            }
			var end2 = new Date().getTime();
            var time2 = end2 - start2;
			
			var myTimeMessage = "Full namespace: " + (time/1000) + "\n" +
								"Reference: " + (time2/1000);
            alert(myTimeMessage);//*/
        
            //lookup speed check//////////////////////////
            /*
            var UnitDefTable = armyc2.c2sd.renderer.utilities.UnitDefTable;
            var start = new Date().getTime();

            for(var i = 0; i < 1000000; i++)
            {
                UnitDefTable.hasUnitDef("S*G*E-----*****");
            }

            var end = new Date().getTime();
            var time = end - start;
			
			
            var myTimeMessage = "UnitDefTable.hasUnitDef: " + (time/1000);
            alert(myTimeMessage);//*/
        
            //getBasicSymbolIDStrict check//////////////////////////
            /*
            var SymbolUtilities = armyc2.c2sd.renderer.utilities.SymbolUtilities;
            var start = new Date().getTime();

            for(var i = 0; i < 1000000; i++)
            {
                SymbolUtilities.getBasicSymbolIDStrict("SFGPE345--MY***");
                //SymbolUtilities.getBasicSymbolIDStrict(null);
            }

            var end = new Date().getTime();
            var time = end - start;
			
			
            var myTimeMessage = "SymbolUtilities.getBasicSymbolIDStrict: " + (time/1000);
            alert(myTimeMessage);//*/
			
			//!! check//////////////////////////
            /*
            var id = "SFGP-----------";
			var b = false;
			var start = new Date().getTime();
            for(var j = 0; j < 90000000; j++)
            {
                if(!!id){}
					//b = true;
            }

            var end = new Date().getTime();
            var time = end - start;
			
			
            var myTimeMessage1 = "(!!object) check" + (time/1000);
            
			// (if) check
			start = new Date().getTime();

            for(var k = 0; k < 90000000; k++)
            {
                if(id){}
					//b = true;
            }

            end = new Date().getTime();
            time = end - start;
			
			
            var myTimeMessage2 = "(object) check" + (time/1000);
            
			
			//!==null, !== undefined check//////////////////////////
            start = new Date().getTime();

            for(var l = 0; l < 90000000; l++)
            {
                if(id !== null && id !== undefined){}
					//b = true;
            }

            end = new Date().getTime();
            time = end - start;
			
			
            var myTimeMessage3 = "null/undefined check" + (time/1000);
			//!== null check//////////////////////////////////////////
			start = new Date().getTime();

            for(var m = 0; m < 90000000; m++)
            {
                if(id !== null){}
					//b = true;
            }

            end = new Date().getTime();
            time = end - start;
			
			
            var myTimeMessage4 = "null check" + (time/1000);
			//!== undefined check
			start = new Date().getTime();

            for(var n = 0; n < 90000000; n++)
            {
                if(id !== undefined){}
					//b = true;
            }

            end = new Date().getTime();
            time = end - start;
			
			
            var myTimeMessage5 = "undefined check" + (time/1000);
			
			
            alert(myTimeMessage1);
			alert(myTimeMessage2);
            alert(myTimeMessage3);
			alert(myTimeMessage4);
            alert(myTimeMessage5);//*/
			
			//charAt time tests/////////////////////////
			/*
            var id = "SFGP-----------";
			var b = false;
			var start = new Date().getTime();
            for(var j = 0; j < 90000000; j++)
            {
                (id.charAt(j%14) === 'S');
            }

            var end = new Date().getTime();
            var time = end - start;
			
			
            var myTimeMessage1 = "(id.charAt(0) === \'S\') check" + (time/1000);
            
			// (if) check
			start = new Date().getTime();

            for(var k = 0; k < 90000000; k++)
            {
                (id.charAt(k%14) === "S");
            }

            end = new Date().getTime();
            time = end - start;
			
			
            var myTimeMessage2 = "(id.charAt(0) === \"S\") check" + (time/1000);
			
			start = new Date().getTime();

            for(var l = 0; l < 90000000; l++)
            {
                (id[l%14] === 'S');
            }

            end = new Date().getTime();
            time = end - start;
			
			
            var myTimeMessage3 = "(id[0] === \'S\')" + (time/1000);
			alert(myTimeMessage1);
			alert(myTimeMessage2);
            alert(myTimeMessage3);//*/


			
            //TEST FUNCTIONS/////////////////////////////
			/*var batch = "{\"iconURLs\":[\"SFGP------*****?size=35&T=Hello\",\"SHGPE-----*****?size=50\"]}";
			var bdfshg = sec.web.renderer.SECWebRenderer.getSinglePointInfoBatch(batch);
			console.log(bdfshg);*/
			
			
            /*

            var sd = armyc2.c2sd.renderer.utilities.SymbolDefTable.getSymbolDef("G*G*SLA---****X");
            var ud = armyc2.c2sd.renderer.utilities.UnitDefTable.getUnitDef("S*G*E-----*****");
            var canHas = armyc2.c2sd.renderer.utilities.SymbolUtilities.canUnitHaveModifier("SFGPU-----*****",armyc2.c2sd.renderer.utilities.ModifiersUnits.AA_SPECIAL_C2_HQ);
            var basic = armyc2.c2sd.renderer.utilities.SymbolUtilities.getBasicSymbolIDStrict("SFGPE-----MO***");


            var pt = new armyc2.c2sd.renderer.utilities.SO.Point(4,5);
            var mySO = armyc2.c2sd.renderer.utilities.SO;
            var pt2 = new mySO.Point(6,7);
            //writes after because it breaks debugging.
            document.writeln(sd.maxPoints);
            document.writeln("<br/>");
            document.writeln(ud.description);
            document.writeln("<br/>");
            document.writeln(canHas);
            document.writeln("<br/>");
            document.writeln(basic);
            document.writeln("<br/>");
            document.writeln(pt.toStringFormatted());
            document.writeln("<br/>");
            document.writeln(pt.x);
            document.writeln("<br/>");
            document.writeln(pt2.toStringFormatted());
            document.writeln("<br/>");
            document.writeln(ii.toDataUrl());//*/
/*
			var ErrorLogger = armyc2.c2sd.renderer.utilities.ErrorLogger;
			ErrorLogger.setLevel(ErrorLogger.FINE);
			try
			{
				//var foo = my.bug;
                                var integer = 255;
                                //var str = Number(integer).toString(16);
                                var str = integer.toString(16);
                                var result = str.length === 1 ? "0" + str : str;
                                
                                ErrorLogger.LogMessage("","",result);
                                
			}
			catch(err)
			{
				ErrorLogger.LogException("class","method",err);
				ErrorLogger.LogWarning("class","method",err);
				ErrorLogger.LogMessage("class","method",err,ErrorLogger.FINE);
			}
//var poo = the.bug;//*/
            //*///END TEST FUNCTIONS/////////////////////
	}
	
        function populateModifiers()
        {
            var modifiers = {};
            
            
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.C_QUANTITY]=10;
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.H_ADDITIONAL_INFO_1] = "Hj";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.H1_ADDITIONAL_INFO_2] = "H1";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.H2_ADDITIONAL_INFO_3] = "H2";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.X_ALTITUDE_DEPTH] = "X";//X
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.K_COMBAT_EFFECTIVENESS] = "K";//K
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.Q_DIRECTION_OF_MOVEMENT] = "45";//Q

            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.W_DTG_1] = armyc2.c2sd.renderer.utilities.SymbolUtilities.getDateLabel(new Date());//W
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.W1_DTG_2] = armyc2.c2sd.renderer.utilities.SymbolUtilities.getDateLabel(new Date());//W1
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.J_EVALUATION_RATING] = "J";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.M_HIGHER_FORMATION] = "Mj";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.N_HOSTILE] = "ENY";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.P_IFF_SIF] = "P";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.Y_LOCATION] = "Y";
            
            //if(symbol.getSymbolID().startsWith("G"))
                modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.C_QUANTITY] = "C";
            
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.F_REINFORCED_REDUCED] = "RD";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.L_SIGNATURE_EQUIP] = "!";
            //modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.AA_SPECIAL_C2_HQ] = "AA";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.G_STAFF_COMMENTS] = "G";
            //symbol.symbolicon A
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.V_EQUIP_TYPE] = "V";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.T_UNIQUE_DESIGNATION_1] = "T";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.T1_UNIQUE_DESIGNATION_2] = "T1";
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.Z_SPEED] = "999";//Z
            //*/
            modifiers[armyc2.c2sd.renderer.utilities.ModifiersUnits.CN_CPOF_NAME_LABEL] = "CPOF'D";//Z
            
            return modifiers;
        }
        
        function checkFonts()
	{
            if(armyc2.c2sd.renderer.utilities.RendererUtilities.fontsLoaded())
            {
                console.log("fonts loaded");
                var button = document.getElementById("btnRender");
                button.disabled = false;
                button.innerHTML = "Render";
            }
            else if(attempts < retries)
            {
                attempts++;
                fontCheckTimer = setTimeout(checkFonts, 1000);
                console.log("fonts loading...");
                //sometimes font won't register until after a render attempt
                armyc2.c2sd.renderer.MilStdIconRenderer.Render("SHAPWMSA-------",{});
            }
            else
            {
                console.log("fonts didn't load or status couldn't be determined for " + retries + " seconds.");
                var button = document.getElementById("btnRender");
                button.disabled = false;
                button.innerHTML = "Render";
            }

	}
	function speedTest(type)
	{
		//PERFORMANCE TEST///////////////////////////
		
		var start = new Date().getTime();
		var modifiers;
		//modifiers = populateModifiers();//render time increases with the number of modifiers
		//modifiers["RENDER"] = false;//dimensions without labels
		var apID = "GFGPGPP---****X";//action point
		var dmID = "SUGDUSAT--MY***";//symbol with display modifiers, will add to render time
		var plainID = "SUGPUSAT----***";//plain symbol with no display modifiers
		var id;
		if(type === 1)
		{
			id = plainID;
			modifiers = new Object();
		}
		else if(type === 2)
		{
			id = dmID;
			modifiers = new Object();
		}
		else if(type === 3)
		{
			id = dmID;
			modifiers = populateModifiers();
		}
		for(var i = 0; i < 1000; i++)
		{
			armyc2.c2sd.renderer.MilStdIconRenderer.Render(id,modifiers);
		}

		var end = new Date().getTime();
		var time = end - start;
		alert('Render 1k symbols: ' + (time/1000));//*/
	}
	function preload()
	{
		//console.log("preloading...");
		//make sure fonts are loaded.
		if(armyc2.c2sd.renderer.utilities.RendererUtilities.fontsLoaded()){
			console.log("fonts loaded fast");
            var button = document.getElementById("btnRender");
			button.disabled = false;
			button.innerHTML = "Render";
        }
		else
		{
			fontCheckTimer = setTimeout(checkFonts, 1000);
		}//*/
		
		
		armyc2.c2sd.renderer.utilities.RendererSettings.setTextOutlineWidth(1);
		
		var ii1 = armyc2.c2sd.renderer.MilStdIconRenderer.Render("SUGPUSAT----***",{});
		var img = document.getElementById("iST1");
		img.src = ii1.toDataUrl();
		img.width = ii1.getImageBounds().width;
		img.height = ii1.getImageBounds().height;
			
		var ii2 = armyc2.c2sd.renderer.MilStdIconRenderer.Render("SUGDUSAT--MY***",populateModifiers());
		var img2 = document.getElementById("iST2");
		img2.src = ii2.toDataUrl();
		img2.width = ii2.getImageBounds().width;
		img2.height = ii2.getImageBounds().height;
		/*
		armyc2.c2sd.renderer.utilities.RendererSettings.setModifierFont("Arial, sans-serif",9,"bold");//"bold 30pt 'Arial', sans-serif"
		armyc2.c2sd.renderer.utilities.RendererSettings.setTextBackgroundMethod(2);
		armyc2.c2sd.renderer.utilities.RendererSettings.setTextOutlineWidth(1);
		//var batch = "{\"iconURLs\":[\"SFGP------*****?size=35&T=Hello\",\"SHGPE-----*****?size=50\"]}";
		var ii3 = armyc2.c2sd.renderer.MilStdIconRenderer.Render("SFGP------*****",{"SIZE":35,"T":"Hello"});
		var img3 = document.getElementById("batch1");
		img3.src = ii3.toDataUrl();
		img3.width = ii3.getImageBounds().width;
		img3.height = ii3.getImageBounds().height;
			
			var mod = {};
			mod.SIZE = 50;
			mod.W = "Date";
			mod.X = "X";
			mod.V = "35";
			mod.T = "TFOO is angry";
			mod.Z = "speed"
			mod.F = "R";
			mod.G = "G";
			mod.H = "<-- is \"silly\"";
			mod.M = "M";
			mod.N = "ENY"
		var ii4 = armyc2.c2sd.renderer.MilStdIconRenderer.Render("SHGPE-----*****",mod);
		var img4 = document.getElementById("batch2");
		img4.src = ii4.toDataUrl();
		img4.width = ii4.getImageBounds().width;
		img4.height = ii4.getImageBounds().height;
		//*/
	}
</script>
</head>
<BODY bgcolor="Cyan" onload="preload();">
Rendered via HTML5 Canvas:<br/>
<canvas id="preview" width="650" height="200"></canvas>
<button id="btnRender" type='button' onclick='testRender();' disabled>Loading Page</button>
<br/>
<img id="iST1" src="" alt="test" height="35" width="35">
<button id="btnST1" type='button' onclick='speedTest(1);' >Speed Test</button>
<img id="iST2" src="" alt="test" height="35" width="35">
<button id="btnST2" type='button' onclick='speedTest(3);' >Speed Test With Modifiers</button>
<!-- <img id="batch1" src="" alt="batch1" height="35" width="35">
<img id="batch2" src="" alt="batch2" height="35" width="35"> -->


</BODY>
</html>